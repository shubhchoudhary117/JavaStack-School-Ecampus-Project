/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3c68=['_getHeadingNames','indexOf','getRoot','_deriveHeadingElementsFromConversion','createElement','editor','get','push','fire','backward','getChildren','name','documentOutline.headings','editing','includes','change','length','_getActiveHeading','model','activeItemIndex','getChild','_getOutlineDefinitions','toModel','findIndex','domConverter','document','level','text','afterInit','_headingNames','view','modelElement','element','getFirstPosition'];(function(_0x1e1d8f,_0x3c6860){const _0x16149c=function(_0x43f875){while(--_0x43f875){_0x1e1d8f['push'](_0x1e1d8f['shift']());}};_0x16149c(++_0x3c6860);}(_0x3c68,0xe2));const _0x1614=function(_0x1e1d8f,_0x3c6860){_0x1e1d8f=_0x1e1d8f-0x0;let _0x16149c=_0x3c68[_0x1e1d8f];return _0x16149c;};import{Plugin as _0x426622}from'ckeditor5/src/core';import{debounce as _0x59427d}from'lodash-es';import{TreeWalker as _0x1851bd}from'ckeditor5/src/engine';import{getElementText as _0x4d274a,getDefaultFeatureHeadingNames as _0x12451b}from'./utils';import{diff as _0x54675e,diffToChanges as _0x35fd78}from'ckeditor5/src/utils';export default class n extends _0x426622{constructor(){super(...arguments),this[_0x1614('0x7')]=[];}static get['pluginName'](){return'DocumentOutlineUtils';}['init'](){const _0x2f40ec=this[_0x1614('0x11')];this[_0x1614('0x7')]=this[_0x1614('0xc')]();let _0x20cd5e=[];_0x2f40ec[_0x1614('0x1e')]['document']['on']('change',_0x59427d(()=>{const _0x42b022=_0x20cd5e;_0x20cd5e=this[_0x1614('0x21')]();const _0x94e59=_0x54675e(_0x42b022,_0x20cd5e,(_0x8c5aac,_0xcdf185)=>_0x8c5aac[_0x1614('0x4')]===_0xcdf185[_0x1614('0x4')]&&_0x8c5aac['text']===_0xcdf185[_0x1614('0x5')]&&_0x8c5aac[_0x1614('0x9')]===_0xcdf185[_0x1614('0x9')]),_0x16813a=_0x35fd78(_0x94e59,_0x20cd5e),_0x4f0aae=this[_0x1614('0x1d')](),_0x45fa6d=_0x20cd5e[_0x1614('0x1')](_0x45e532=>_0x45e532[_0x1614('0x9')]===_0x4f0aae);_0x16813a[_0x1614('0x1c')]&&this[_0x1614('0x14')](_0x1614('0x1b'),{'outlineDefinitions':_0x20cd5e,'activeItemIndex':_0x45fa6d,'outlineChanges':_0x16813a}),this[_0x1614('0x14')](_0x1614('0x1f'),{'index':_0x45fa6d});},0xfa,{'leading':!0x0,'trailing':!0x0}));}[_0x1614('0x6')](){this['_headingNames'][_0x1614('0x1c')]||this[_0x1614('0xf')]();}[_0x1614('0x21')](){const _0x4521d5=this[_0x1614('0x11')][_0x1614('0x1e')]['document'][_0x1614('0xe')](),_0x2f93ed=[],_0x3f195a=this['_headingNames'];return function _0x53c731(_0x378fa3){for(const _0x256502 of _0x378fa3[_0x1614('0x16')]())_0x256502['is'](_0x1614('0xa'))&&(_0x3f195a[_0x1614('0x1a')](_0x256502[_0x1614('0x17')])&&_0x2f93ed[_0x1614('0x13')]({'level':_0x3f195a[_0x1614('0xd')](_0x256502[_0x1614('0x17')])+0x1,'text':_0x4d274a(_0x256502),'modelElement':_0x256502}),_0x53c731(_0x256502));}(_0x4521d5),_0x2f93ed;}['_getActiveHeading'](){const _0x16fc04=this[_0x1614('0x11')][_0x1614('0x1e')][_0x1614('0x3')]['selection'][_0x1614('0xb')](),_0x1cb17f=new _0x1851bd({'direction':_0x1614('0x15'),'startPosition':_0x16fc04});for(const _0x860110 of _0x1cb17f)if(_0x860110['item']['is'](_0x1614('0xa'))&&this[_0x1614('0x7')][_0x1614('0x1a')](_0x860110['item'][_0x1614('0x17')]))return _0x860110['item'];}[_0x1614('0xc')](){const _0xa1443b=this[_0x1614('0x11')]['config'][_0x1614('0x12')](_0x1614('0x18'));return _0xa1443b||_0x12451b(this[_0x1614('0x11')]);}[_0x1614('0xf')](){const _0x337dd3=this['editor'],_0x487468=['h1','h2','h3','h4','h5','h6'],_0x3cc2e1=[];for(const _0x409d70 of _0x487468){const _0x586eaf=_0x337dd3[_0x1614('0x19')][_0x1614('0x8')][_0x1614('0x2')]['domToView'](document[_0x1614('0x10')](_0x409d70)),_0x54f62d=_0x337dd3['data'][_0x1614('0x0')](_0x586eaf)[_0x1614('0x20')](0x0);(null==_0x54f62d?void 0x0:_0x54f62d['is']('element'))&&_0x3cc2e1[_0x1614('0x13')](_0x54f62d['name']);}this['_headingNames']=_0x3cc2e1;}}