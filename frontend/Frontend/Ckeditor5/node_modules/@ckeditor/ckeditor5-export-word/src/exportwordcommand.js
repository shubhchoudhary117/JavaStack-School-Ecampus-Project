/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x2c74b6}from'ckeditor5/src/core';import{getStyles as _0x137fb6,getConverterOptions as _0x47f583}from'./utils';export default class i extends _0x2c74b6{constructor(_0x3cb250){super(_0x3cb250),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x1cafcc={}){const _0x51c1eb=this['editor'],t=_0x51c1eb['t'],_0x4afe86=_0x1cafcc['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x155988=_0x1cafcc['converterOptions']||{},_0x57b83c=_0x51c1eb['plugins']['get']('ExportWord'),_0x5dc517=_0x1cafcc['token']||_0x57b83c['_token'],_0x195dc6=!0x1!==_0x155988['auto_pagination'],_0x29fe6a=_0x1cafcc['dataCallback']||(_0xe72cdf=>_0xe72cdf['data']['get']({'pagination':_0x195dc6,'ignoreResolvedComments':!0x0}));return this['isBusy']=!0x0,this['refresh'](),_0x137fb6(_0x1cafcc['stylesheets']||['EDITOR_STYLES'])['then'](async _0x2ec9e6=>{const _0x3773f1=await _0x29fe6a(_0x51c1eb),_0x45b705={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x51c1eb['locale']['contentLanguageDirection']+'\x22>'+_0x3773f1+'</div>','css':_0x2ec9e6,'options':{..._0x155988,..._0x47f583(_0x51c1eb)}},_0x4fd265={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x5dc517?{'Authorization':_0x5dc517['value']}:null},'body':JSON['stringify'](_0x45b705)};return window['fetch'](_0x4afe86,_0x4fd265)['then'](_0x28c0c4=>{if(0xc8!==_0x28c0c4['status'])throw _0x28c0c4;return _0x28c0c4['blob']();})['then'](_0x4954f8=>{const _0x39234b='function'==typeof _0x1cafcc['fileName']?_0x1cafcc['fileName']():_0x1cafcc['fileName'];this['_downloadFile'](_0x4954f8,_0x39234b||'document.docx');});})['catch'](_0x95dff5=>{throw _0x51c1eb['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x95dff5;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x87bba6,_0x5edd7d){const _0x5018a9=document['createElement']('a');_0x5018a9['href']=window['URL']['createObjectURL'](_0x87bba6),_0x5018a9['download']=_0x5edd7d,_0x5018a9['click'](),_0x5018a9['remove']();}}